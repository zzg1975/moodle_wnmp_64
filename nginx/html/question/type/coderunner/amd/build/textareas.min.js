define ("qtype_coderunner/textareas",["jquery"],function(a){function b(){a(this).data("clickInProgress",!1);a(this).data("capturingTab",!0);a(this).on("mousedown",function(){a(this).data("clickInProgress",!0)});a(this).on("focusin",function(){a(this).data("capturingTab",a(this).data("clickInProgress"))});a(this).on("click",function(){a(this).data("clickInProgress",!1)});a(this).on("keydown",function(b){if(window.hasOwnProperty("behattesting")&&window.behattesting){return}if(b.which===void 0||0!==b.which){if(b.keyCode==9&&a(this).data("capturingTab")){if(b.shiftKey||c(this,"    ")){b.preventDefault()}}else if(b.keyCode===13&&this.selectionStart!==void 0){for(var d=this.value.substring(0,this.selectionStart),e=d.lastIndexOf("\n"),f=d.substring(e+1),g="",h=0;h<f.length&&" "===f.charAt(h);h++){g=g+" "}if(c(this,"\n"+g)){b.preventDefault()}a(this).data("capturingTab",!0)}else if(b.keyCode===77&&b.ctrlKey&&!b.altKey){a(this).data("capturingTab",!a(this).data("capturingTab"));b.preventDefault()}else if(b.keyCode===27){a(this).data("capturingTab",!1)}else if(!(b.ctrlKey||b.altKey)){a(this).data("capturingTab",!0)}}})}function c(a,b){if(a.selectionStart!==void 0){var c=a.value.substring(0,a.selectionStart),d=a.selectionEnd,e=a.value.substring(a.selectionEnd,a.value.length),f=a.scrollTop;a.value=c+b+e;var g=d+b.length;a.selectionStart=g;a.selectionEnd=g;a.scrollTop=f;return!0}else if(document.selection&&document.selection.createRange){var h=document.selection.createRange(),i=h.duplicate();i.moveToElementText(a);i.setEndPoint("EndToEnd",h);h.text=b;return!0}else{return!1}}return{setupAllTAs:function(){a("textarea.edit_code").each(b)},initQuestionTA:function(c){a(document.getElementById(c)).each(b)}}});
//# sourceMappingURL=textareas.min.js.map

{"version":3,"sources":["../src/validateFace.js"],"names":["define","$","Ajax","Notification","setup","css","click","event","preventDefault","photo","document","getElementById","canvas","video","context","getContext","drawImage","width","height","data","toDataURL","setAttribute","courseid","value","cmid","profileimage","call","methodname","args","done","warnings","length","status","style","display","addNotification","message","type","fail","exception"],"mappings":"AAAAA,OAAM,sCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgC,CAC5B,MAAO,CACHC,KAAK,CAAE,gBAAW,CAEdH,CAAC,CAAC,qBAAD,CAAD,CAAyBI,GAAzB,CAA6B,SAA7B,CAAwC,KAAxC,EAEAJ,CAAC,CAAC,aAAD,CAAD,CAAiBK,KAAjB,CAAuB,UAAW,CAC9BC,KAAK,CAACC,cAAN,GAD8B,GAG1BC,CAAAA,CAAK,CAAGC,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CAHkB,CAI1BC,CAAM,CAAGF,QAAQ,CAACC,cAAT,CAAwB,QAAxB,CAJiB,CAK1BE,CAAK,CAAGH,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CALkB,CAM1BG,CAAO,CAAGF,CAAM,CAACG,UAAP,CAAkB,IAAlB,CANgB,CAO9BD,CAAO,CAACE,SAAR,CAAkBH,CAAlB,CAAyB,CAAzB,CAA4B,CAA5B,CAA+BD,CAAM,CAACK,KAAtC,CAA6CL,CAAM,CAACM,MAApD,EACA,GAAIC,CAAAA,CAAI,CAAGP,CAAM,CAACQ,SAAP,CAAiB,WAAjB,CAAX,CACAX,CAAK,CAACY,YAAN,CAAmB,KAAnB,CAA0BF,CAA1B,EAT8B,GAW1BG,CAAAA,CAAQ,CAAGZ,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCY,KAXxB,CAY1BC,CAAI,CAAGd,QAAQ,CAACC,cAAT,CAAwB,SAAxB,EAAmCY,KAZhB,CAa1BE,CAAY,CAAGf,QAAQ,CAACC,cAAT,CAAwB,cAAxB,EAAwCY,KAb7B,CA6B9BrB,CAAI,CAACwB,IAAL,CAAU,CALI,CACVC,UAAU,CATG,qCAQH,CAEVC,IAAI,CATK,CACT,SAAYN,CADH,CAET,KAAQE,CAFC,CAGT,aAAgBC,CAHP,CAIT,cAAiBN,CAJR,CAOC,CAKJ,CAAV,EAAqB,CAArB,EAAwBU,IAAxB,CAA6B,SAASV,CAAT,CAAe,CACxC,GAA2B,CAAvB,CAAAA,CAAI,CAACW,QAAL,CAAcC,MAAlB,CAA8B,CAG1B,GAAIC,CAAAA,CAAM,CAAGb,CAAI,CAACa,MAAlB,CACA,GAAc,SAAV,EAAAA,CAAJ,CAAyB,CACrB/B,CAAC,CAAC,QAAD,CAAD,CAAYI,GAAZ,CAAgB,QAAhB,CAA0B,kBAA1B,EACAK,QAAQ,CAACC,cAAT,CAAwB,eAAxB,EAAyCsB,KAAzC,CAA+CC,OAA/C,CAAyD,MAAzD,CACAxB,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCsB,KAAvC,CAA6CC,OAA7C,CAAuD,OAC1D,CAJD,IAIO,CACHjC,CAAC,CAAC,QAAD,CAAD,CAAYI,GAAZ,CAAgB,QAAhB,CAA0B,gBAA1B,CACH,CACJ,CAXD,IAWO,CACH,GAAIQ,CAAJ,CAAW,CACPV,CAAY,CAACgC,eAAb,CAA6B,CACzBC,OAAO,CAAE,+CADgB,CAEzBC,IAAI,CAAE,OAFmB,CAA7B,CAIH,CACJ,CACJ,CApBD,EAoBGC,IApBH,CAoBQnC,CAAY,CAACoC,SApBrB,CAsBH,CAnDD,EAoDA,QACH,CA1DE,CA4DV,CA9DC,CAAN","sourcesContent":["define(['jquery', 'core/ajax', 'core/notification'],\n    function($, Ajax, Notification) {\n        return {\n            setup: function() {\n                // Console.log('validate face called');\n                $(\"#fgroup_id_buttonar\").css(\"padding\", \"5px\");\n\n                $(\"#fcvalidate\").click(function() {\n                    event.preventDefault();\n                    // Console.log('validate clicked');\n                    var photo = document.getElementById('photo');\n                    var canvas = document.getElementById('canvas');\n                    var video = document.getElementById('video');\n                    var context = canvas.getContext('2d');\n                    context.drawImage(video, 0, 0, canvas.width, canvas.height);\n                    var data = canvas.toDataURL('image/png');\n                    photo.setAttribute('src', data);\n\n                    var courseid = document.getElementById('courseidval').value;\n                    var cmid = document.getElementById('cmidval').value;\n                    var profileimage = document.getElementById('profileimage').value;\n                    // Var currentimage = document.getElementById('currentimage').value;\n\n                    var wsfunction = 'quizaccess_proctoring_validate_face';\n                    var params = {\n                        'courseid': courseid,\n                        'cmid': cmid,\n                        'profileimage': profileimage,\n                        'webcampicture': data,\n                    };\n\n                    var request = {\n                        methodname: wsfunction,\n                        args: params\n                    };\n\n                    Ajax.call([request])[0].done(function(data) {\n                        if (data.warnings.length < 1) {\n                            // NO; pictureCounter++;\n                            // console.log('api response', data);\n                            var status = data.status;\n                            if (status == 'success') {\n                                $(\"#video\").css(\"border\", \"10px solid green\");\n                                document.getElementById(\"validate_form\").style.display = \"none\";\n                                document.getElementById(\"accept_form\").style.display = \"block\";\n                            } else {\n                                $(\"#video\").css(\"border\", \"10px solid red\");\n                            }\n                        } else {\n                            if (video) {\n                                Notification.addNotification({\n                                    message: 'Something went wrong during taking the image.',\n                                    type: 'error'\n                                });\n                            }\n                        }\n                    }).fail(Notification.exception);\n\n                });\n                return true;\n            }\n        };\n    });\n"],"file":"validateFace.min.js"}